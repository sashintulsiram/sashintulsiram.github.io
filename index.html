<!DOCTYPE html>
<html>
    <head>
        
        <!-- Google Tag Manager -->
        <script>
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-TV43V3SG');
        </script>
        <!-- End Google Tag Manager -->        

        <script>
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const page_url = urlParams.get('page_url')        
            //console.log(page_type);

            const key = urlParams.get('key')
            //console.log(key);
            const value = urlParams.get('value')
            //console.log(value);    
            let key_var = key
            let value_var = value                     
        </script>

        <script>
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
             'key': key_var,
             'value': value_var
            });
        </script>
        



        <title>Sashin Tulsiram - Technical Challenge</title>
    </head>

    <body>
        <!-- Google Tag Manager (noscript) -->
        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TV43V3SG"
            height="0" width="0" style="display:none;visibility:hidden">
            </iframe>
        </noscript>
        <!-- End Google Tag Manager (noscript) -->    

        <h2>This is a Test website which performs the below functions: </h2>
        <ol>
            <li>Google Tag Manager and Query String Parameters</li>            
            <li>Testing of Other Query String Parameters</li>
            <li>API Implementation</li>            
        </ol>
    
        <h3>1. Google Tag Manager and Query String Parameters</h3>
            <ul>
                <li>The Google Tag Manager code snippet required for the integration was added to the source code.</li> 
                <li>A JavaScript function was created to dynamically assign the inputted key and value pair into their own separate variables (key, value).</li>
                <li>A JavaScript function was created to dynamically push the key and value variable data to Google's Tag Managers Data Layer.  </li>
                <li>Google Tag Manager was successfully implemented and tested. The applications functionality to push data to the GTM data layer was also tested successfully. </li>
            </ul>        

        <h3>2. Testing of Other Query String Parameters</h3>
            <div>
                <ol>
                    <li>To test if Query String Parameters are hardcoded, update the Query String Parameters within the URL and press Enter to refresh your web browser.</li>
                    <li>Confirm if the Query String Parameters were successfully updated by referencing the below data for the inputted key and value: </li>
                        <ul>
                            <li>Key: <p id="key_id"></p></li>
                            <li>Value: <p id="value_id"></p></li>
                        </ul>
                </ol>        

                <script>
                    document.getElementById('key_id').innerHTML = key_var
                    document.getElementById('value_id').innerHTML = value_var       
                </script>                                    
            </div>

        <h3>3. API Implementation</h3>
            <div>
                <script>
                    window.dataLayer.push(function() {
                        const key_dataLayer = this.get('key');
                        if (key_dataLayer !== null) {
                        // Change behavior based on whether or not this value exists...
                        } else {
                        // ...
                        }
                        console.log(key_dataLayer)
                    })
            
                </script>



                <button type="button" onclick="alert('API Response Logged in Console!')">Send API Request!</button>
            </div>        
    </body>
</html>
